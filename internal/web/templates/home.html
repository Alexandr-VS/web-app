<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Генератор пакетов</title>
    <style>
        .valid {
            border-color: green;
            background-color: lightgreen;
        }
        .invalid {
            border-color: red;
            background-color: lightcoral;
        }
    </style>
</head>
<body>
    <h1>Отправитель пакетов</h1>
    <form action="/send" method="post" enctype="multipart/form-data">

        <div style="margin-bottom: 10px;">

            <label for="mac-src">MAC-адрес источника:</label>
            <input type="text" placeholder="Введите MAC-адрес:" id="mac-src" name="mac-src" oninput="validateMAC(this)" required>
            <small>Формат: xx:xx:xx:xx:xx:xx или xx-xx-xx-xx-xx-xx</small>
            <br><br>

            <label for="mac-dst">MAC-адрес получателя:</label>
            <input type="text" placeholder="Введите MAC-адрес" id="mac-dst" name="mac-dst" oninput="validateMAC(this)" required>
            <small>Формат: xx:xx:xx:xx:xx:xx или xx-xx-xx-xx-xx-xx</small>
            <br><br>

            <label for="ip-src">IP-адрес источника:</label>
            <input type="text" placeholder="Введите IP-адрес" id="ip-src" name="ip-src" oninput="validateIP(this)" required>
            <small>Формат: xxx.xxx.xxx.xxx</small>
            <br><br>

            <label for="ip-dst">IP-адрес получателя:</label>
            <input type="text" placeholder="Введите IP-адрес" id="ip-dst" name="ip-dst" oninput="validateIP(this)" required>
            <small>Формат: xxx.xxx.xxx.xxx</small>
            <br><br>

            <label for="src-port">Порт источника:</label>
            <input type="text" placeholder="Введите номер порта" id="src-port" name="src-port" oninput="validatePort(this)" required>
            <br><br>

            <label for="dst-port">Порт получателя:</label>
            <input type="text" placeholder="Введите номер порта" id="dst-port" name="dst-port" oninput="validatePort(this)" required>
            <br><br>

        </div>
        
        <div style="margin-bottom: 20px;">
            <label>Источник данных:</label><br style="margin-bottom: 20px;">
            <div style="margin-bottom: 10px;">
                <input type="radio" id="pseudoRand" name="dataSource" value="pseudoRand" checked onclick="toggleFileInput()">
                <label for="pseudoRand">ПСП с большим периодом</label>
            </div>

            <div>
                <input type="radio" id="file" name="dataSource" value="file" onclick="toggleFileInput()">
                <label for="file">Файл</label><br style="margin-bottom: 10px;">
                <input type="file" id="filename" name="filename" style="display: none;">
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <label for="countOfPackets">Количество пакетов:</label>
            <input type="number" placeholder="Введите число" id="countOfPackets" name="countOfPackets" required>
        </div>

        <div style="margin-bottom: 20px;">
            <label for="interval">Интервал:</label>
            <input type="number" placeholder="Введите число" id="interval" name="interval" required>
            <label for="interval">сек</label>
        </div>

        <button type="submit">Сгенерировать пакет</button>

    </form>

    <script>
        function toggleFileInput() {
            const fileInput = document.getElementById('filename');
            const pseudoRandOption = document.getElementById('pseudoRand');
            
            if (pseudoRandOption.checked) {
                fileInput.style.display = 'none';
            } else {
                fileInput.style.display = 'block';
            }
        }

        function validateIP(input) {
            const ipPattern = /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
            if (ipPattern.test(input.value)) {
                input.classList.add('valid');
                input.classList.remove('invalid');
            } else {
                input.classList.add('invalid');
                input.classList.remove('valid');
            }
        }

        function validateMAC(input) {
            const macPattern = /^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/;
            if (macPattern.test(input.value)) {
                input.classList.add('valid');
                input.classList.remove('invalid');
            } else {
                input.classList.add('invalid');
                input.classList.remove('valid');
            }
        }

        function validatePort(input){
            const port = parseInt(input.value, 10);
            if (!isNaN(port) && Number.isInteger(port) && port >= 0 && port <= 65535) {
                input.classList.add('valid');
                input.classList.remove('invalid')
            } else {
                input.classList.add('invalid');
                input.classList.remove('valid');
            }
        }

        function checkInputsOnLoad() {
            const ipSrcInput = document.getElementById('ip-src');
            const ipDstInput = document.getElementById('ip-dst');
            const macSrcInput = document.getElementById('mac-src');
            const macDstInput = document.getElementById('mac-dst');
            const portSrcInput = document.getElementById('src-port');
            const portDstInput = document.getElementById('dst-port');

            validateIP(ipSrcInput);
            validateIP(ipDstInput);
            validateMAC(macSrcInput);
            validateMAC(macDstInput);
            validatePort(portSrcInput);
            validatePort(portDstInput);
        }

        document.addEventListener('DOMContentLoaded', () => {
            checkInputsOnLoad();
            toggleFileInput();
        });

    </script>
</body>
</html>